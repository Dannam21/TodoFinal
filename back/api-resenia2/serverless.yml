service: microservicio-resenas

provider:
  name: aws
  runtime: nodejs18.x
  memorySize: 1024
  timeout: 30
  iam:
    role: arn:aws:iam::385301667309:role/LabRole
  environment:
    TABLE_NAME: Resenas  # Asegúrate que el nombre de la tabla sea correcto

functions:
  crearResena:
    handler: handler.crearResena
    events:
      - http:
          path: resenas
          method: post
  obtenerResenas:
    handler: handler.obtenerResenas
    events:
      - http:
          path: resenas/{tenant_id}/{producto_id}
          method: get
  actualizarResena:
    handler: handler.actualizarResena
    events:
      - http:
          path: resenas
          method: put
  eliminarResena:
    handler: handler.eliminarResena
    events:
      - http:
          path: resenas
          method: delete

resources:
  Resources:
    ResenasTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: Resenas  # Asegúrate de que el nombre de la tabla coincida con la variable de entorno
        AttributeDefinitions:
          - AttributeName: tenant_id_producto_id  # Nombre correcto para el atributo de partición
            AttributeType: S
          - AttributeName: resenia_id
            AttributeType: S
        KeySchema:
          - AttributeName: tenant_id_producto_id  # Usar el nombre de partición correcto
            KeyType: HASH
          - AttributeName: resenia_id
            KeyType: RANGE
        BillingMode: PAY_PER_REQUEST
